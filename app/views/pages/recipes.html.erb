<div class="recipes-container">
  <h1>Our Recipe Collection</h1>

  <div class="search-container">
    <%= form_with(url: recipes_path, method: :get, class: "search-form") do |f| %>
      <div class="search-input-group">
        <%= f.text_field :search,
            value: params[:search],
            placeholder: "Search recipes by title, ingredients, or dietary labels...",
            class: "search-input" %>

        <%= f.select :category,
            options_for_select([['All Categories', '']] + @categories.map { |c| [c, c] }, params[:category]),
            {},
            class: "category-select" %>

        <%= f.submit "Search", class: "search-button" %>
      </div>
    <% end %>
  </div>

  <div class="category-filters">
    <h2>Browse by Category</h2>
    <div class="category-buttons">
      <% categories = ['Beef', 'Chicken', 'Dessert', 'Lamb', 'Miscellaneous', 'Pasta', 'Pork', 'Seafood', 'Side', 'Starter', 'Vegan', 'Vegetarian', 'Breakfast', 'Goat'] %>
      <% categories.each do |category| %>
        <a href="<%= category_path(category) %>" class="category-btn">
          <i class="fas fa-tag"></i> <%= category %>
        </a>
      <% end %>
    </div>
  </div>

  <div class="recipes-grid">
    <% @recipes.each do |recipe| %>
      <div class="recipe-card">
        <a href="<%= recipe_path(recipe) %>" class="recipe-link">
          <div class="recipe-image" style="background-image: url('<%= recipe.image_url %>');">
            <div class="cooking-time">
              <i class="far fa-clock"></i> <%= recipe.cooking_time %> min
            </div>
          </div>

          <div class="recipe-content">
            <h3><%= recipe.title %></h3>

            <div class="recipe-info">
              <span class="info-item">
                <i class="fas fa-utensils"></i> <%= recipe.dietary_labels %>
              </span>
            </div>

            <div class="recipe-ingredients">
              <strong>Ingredients:</strong>
              <p><%= truncate(recipe.ingredients_list, length: 150) %></p>
            </div>
          </div>
        </a>
      </div>
    <% end %>
  </div>

  <div class="pagination">
    <%= paginate @recipes, window: 2 %>
  </div>
</div>